str_detect("Hallo", "H")
if(!require(dplyr)){
install.packages("dplyr")
require(dplyr)
}
if(!require(data.table)){
install.packages("data.table")
require(data.table)
}
if(!require(ggplot2)){
install.packages("ggplot2")
require(ggplot2)
}
if(!require(fitdistrplus)){
install.packages("fitdistrplus")
require(fitdistrplus)
}
if(!require(goft)){
install.packages("goft")
require(goft)
}
if(!require(tidyverse)){
install.packages("tidyverse")
require(tidyverse)
}
df_K7 <- fread('D:/UNI/IDA CaseStudy/Data/Logistikverzug/Komponente_K7.csv')        #Extract production date from here
df_logistic_delay = fread('D:/UNI/IDA CaseStudy/Data/Logistikverzug/Logistikverzug_K7.csv') #Extract receiving date from here
#Merge both dataframes and keep relevant columns (production - receiption - ID-Number)
df_combi = dplyr::select(merge(df_K7, df_logistic_delay, by='IDNummer'), 'IDNummer', 'Produktionsdatum', 'Wareneingang')
#Convert character to date datatype
df_combi$Wareneingang <- as.Date(df_combi$Wareneingang, "%d.%m.%Y")
df_combi$Produktionsdatum <- as.Date(df_combi$Produktionsdatum, "%Y-%m-%d")
#Calculate logistic delay as difference of Production and receiving date
df_combi$delay = as.numeric(df_combi$Wareneingang - df_combi$Produktionsdatum)
#Registrations:
Zulassungen = fread("D:/UNI/IDA CaseStudy/Data/Zulassungen/Zulassungen_alle_Fahrzeuge.csv", header = TRUE )
Bestandteile_Fahrzeuge_1 <- fread('D:/UNI/IDA CaseStudy/Data/Fahrzeug/Bestandteile_Fahrzeuge_OEM1_Typ11.csv', header=TRUE)
Bestandteile_Fahrzeuge_2 <- fread('D:/UNI/IDA CaseStudy/Data/Fahrzeug/Bestandteile_Fahrzeuge_OEM1_Typ12.csv', header=TRUE)
Bestandteile_Fahrzeuge_3 <- fread('D:/UNI/IDA CaseStudy/Data/Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ21.csv', header=TRUE)
Bestandteile_Fahrzeuge_4 <- fread('D:/UNI/IDA CaseStudy/Data/Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ22.csv', header=TRUE)
#Rename First column of Bestandteile_Fahrzeuge_4 from "X1" to "V1" and merge all files together
colnames(Bestandteile_Fahrzeuge_4)[1] = 'V1'
Bestandteile_Fahrzeuge_complete <- rbind(Bestandteile_Fahrzeuge_1, Bestandteile_Fahrzeuge_2, Bestandteile_Fahrzeuge_3, Bestandteile_Fahrzeuge_4)
str_detect("Hallo", "H")
head(Bestandteile_Fahrzeuge_complete %>% filter(str_detect("K7")))
head(Bestandteile_Fahrzeuge_complete %>% filter(ID_Fahrzeug, str_detect("K7")))
head(Bestandteile_Fahrzeuge_complete %>% filter(str_detect(ID_Fahrzeug, "K7")))
head(Bestandteile_Fahrzeuge_complete %>% filter(str_detect(ID_Karosserie, "K7")))
nrow(Bestandteile_Fahrzeuge_complete %>% filter(str_detect(ID_Karosserie, "K7")))
K7_Cars_ID <- dplyr::select(Bestandteile_Fahrzeuge_complete %>% filter(str_detect(ID_Karosserie, "K7")), ID_Fahrzeug)
K7_cars_Dortmund <- K7_Cars_ID %>% merge(Zulassungen, by.x='ID_Fahrzeug', by.y='IDNummer') %>% filter(Gemeinden == 'DORTMUND')
K7_cars_Dortmund <- K7_Cars_ID %>% merge(Zulassungen, by.x='ID_Fahrzeug', by.y='IDNummer') %>% filter(Gemeinden == 'DORTMUND')
#Now we have a data frame containing all cars with component K7 that are registered in Dortmund
#Get the number of those cars by counting the rows of that data frame
nrow(K7_cars_Dortmund)
summary(Zulassungen)
str(Zulassungen)
View(Bestandteile_Fahrzeuge_complete)
head(Bestandteile_Fahrzeuge_complete)
head(Zulassungen)
#Wanted ID:
ID_wanted <- "K1BE2-104-1041-32049"
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted)["ID_Fahrzeug"]
head(Bestandteile_Fahrzeuge_complete)
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted)
#Wanted ID:
ID_wanted <- "K1BE2-104-1041-32049"
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted) %>% select("IDNummer")
#Wanted ID:
ID_wanted <- "K1BE2-104-1041-32049"
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted) %>% select("ID_Fahrzeug")
#Wanted ID:
ID_wanted <- "K1BE2-104-1041-32049"
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted) %>% dplyr::select("ID_Fahrzeug")
Zulassungen %>% filter(IDNummer == ID_Car) %>% dplyr::select("Gemeinden")
ID_Car
head(Zulassungen)
Zulassungen %>% filter(IDNummer == ID_Car)
Zulassungen %>% filter(str_detect(IDNummer, ID_Car))
Zulassungen %>% filter(str_detect("IDNummer", ID_Car))
ID_Car
ID_Car[1]
ID_Car[[1]
]
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted) %>% dplyr::select("ID_Fahrzeug")[]
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted) %>% dplyr::select("ID_Fahrzeug")[1]
#Wanted ID:
ID_wanted <- "K1BE2-104-1041-32049"
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted) %>% dplyr::select("ID_Fahrzeug")
Zulassungen %>% filter(IDNummer == ID_Car[[1]]) %>% dplyr::select("Gemeinden")
fit.lognormal <- fitdist(df_combi$delay, "lnorm")
fit.lognormal
plot(fit.gamma)
fit.gamma <- fitdist(df_combi$delay, "gamma")
fit.gamma <- fitdist(df_combi$delay, "gamma")
plot(fit.gamma)
shiny::runApp('D:/UNI/Uni Synchro/DAP/Projekt/Gruppe_05_DQE2019')
runApp('D:/UNI/Uni Synchro/DAP/Projekt/Gruppe_05_DQE2019')
runApp('D:/UNI/Uni Synchro/DAP/Projekt/Gruppe_05_DQE2019')
library(shiny); runApp('App_Case_Study_Group_20/Case_Study_App_Group_20.R')
grid.arrange(plot1, plot2, ncol=2)
library(ggplot2)
tmpenv <- new.env()
str <- "E:/TU Berlin/Case_Study_Group_20/Data/Final_Data_Group_20_original.RData"
load(str, envir=tmpenv)
x <- tmpenv$Data
region_cars <- complete_information %>%
ungroup() %>%
group_by(Region)%>%
filter(Zulassung <= input$banDate)%>%
filter(Region == input$regionCode)%>%
mutate(Anzahl_Diesel = sum(ID_Motor == "Diesel"), Anzahl_Benzin = sum(ID_Motor == "Benzin"))%>%
select(Anzahl_Diesel, Anzahl_Benzin)
small_cars_df <- data.frame(
Motor = c("Diesel", "Benzin"),
Number = c(region_cars$Anzahl_Diesel[1], region_cars$Anzahl_Benzin[1])) %>%
mutate(partial= Number / sum(Number)) %>%
mutate(labels= paste(percent(partial)," (",Number, ")", sep = ""))
small_cars_bp<- ggplot(small_cars_df, aes(x="", y=Number, fill=Motor)) +
geom_bar(width = 0.9, stat = "identity", color= "black")
pie <- small_cars_bp + coord_polar("y", start=0)
pie2 <- pie +
scale_fill_brewer(palette="Greens") +
geom_text(aes(y = Number/2 + c(0, cumsum(Number)[-length(Number)]),
label = labels), size=4) +
ggtitle("Affected car owners in ban region: ", region_cars$Anzahl_Diesel[1]) +
theme(axis.title = element_blank(),
plot.title = element_text(face = "bold", size = 16))
affected <- region_cars$Anzahl_Diesel[1]
national_df <- data.frame(
Parts = c(nrow(complete_information)-affected, affected),
Labels = c("Unaffected", "Affected")
)
national_bp <- ggplot(national_df, aes(x="", y=Parts, fill=Labels)) +
geom_bar(width = 0.9, stat = "identity", color= "white") + coord_polar("y", start=0)
require(gridExtra)
plot1 <- qplot(pie2)
plot2 <- qplot(national_bp)
grid.arrange(plot1, plot2, ncol=2)
plot_grid(pie2, national_bp, labels = "AUTO")
plot_grid(pie2, national_bp, labels = "AUTO")
library(cowplot)
install.packages("cowplot")
library(cowplot)
plot_grid(pie2, national_bp, labels = "AUTO")
pie2 <- pie +
scale_fill_brewer(palette="Greens") +
geom_text(aes(y = Number/2 + c(0, cumsum(Number)[-length(Number)]),
label = labels), size=4) +
ggtitle("Affected car owners in ban region: ", region_cars$Anzahl_Diesel[1]) +
theme(axis.title = element_blank(),
plot.title = element_text(face = "bold", size = 16))
affected <- region_cars$Anzahl_Diesel[1]
national_df <- data.frame(
Parts = c(nrow(complete_information)-affected, affected),
Labels = c("Unaffected", "Affected")
)
national_bp <- ggplot(national_df, aes(x="", y=Parts, fill=Labels)) +
geom_bar(width = 0.9, stat = "identity", color= "white") + coord_polar("y", start=0)
plot_grid(pie2, national_bp, labels = "AUTO")
affected <- region_cars$Anzahl_Diesel[1]
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
load("E:/TU Berlin/Case_Study_Group_20/Neuste Version/IDACase_Study/Case_Study_Group_20/App_Case_Study_Group_20/Final_Data_Group_20_original.RData")
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
national_bp <- ggplot(national_df, aes(x="", y=Parts, fill=Labels)) +
geom_bar(width = 0.9, stat = "identity", color= "white") + coord_polar("y", start=0) +
scale_fill_brewer(palette="Greens") +
ggtitle("Affected car owners nationally: ", national_df$Parts[1]) +
theme(axis.title = element_blank(),
plot.title = element_text(face = "bold", size = 16))
plot_grid(pie2, national_bp, labels = c("Regional", "National"))
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
national_df <- data.frame(
Parts = c(nrow(complete_information)-affected, affected),
Group = c("Unaffected", "Affected"),
mutate(partial= Parts / sum(Parts)) %>%
mutate(labels= paste(percent(partial)," (",Parts, ")", sep = ""))
)
national_bp <- ggplot(national_df, aes(x="", y=Parts, fill=Labels)) +
geom_bar(width = 0.9, stat = "identity", color= "white") + coord_polar("y", start=0) +
scale_fill_brewer(palette="Greens") +
geom_text(aes(y = Parts/2 + c(0, cumsum(Parts)[-length(Parts)]),
label = labels), size=4) +
theme(axis.title = element_blank(),
plot.title = element_text(face = "bold", size = 16))
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
small_cars_df$Number
summary(small_cars_df)
str(small_cars_df)
national_bp <- ggplot(national_df, aes(x="", y=Parts, fill=Labels)) +
geom_bar(width = 0.9, stat = "identity", color= "white") + coord_polar("y", start=0) +
scale_fill_brewer(palette="Greens") +
geom_text(aes(y = Parts/2 + c(0, cumsum(Parts)[-length(Parts)]),
label = labels), size=4) +
theme(axis.title = element_blank(),
plot.title = element_text(face = "bold", size = 16))
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
str(region_cars)
typeof(region_cars$Anzahl_Diesel[1])
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
load("E:/TU Berlin/Case_Study_Group_20/Neuste Version/IDACase_Study/Case_Study_Group_20/App_Case_Study_Group_20/Final_Data_Group_20_original.RData")
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
library(shiny); runApp('App_Case_Study_Group_20/Case_Study_App_Group_20.R')
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white") + coord_polar("y", start=0) + facet_grid(. ~ Area)
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, color= "white") + coord_polar("y", start=0) + facet_grid(. ~ Area)
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white") + coord_polar("y", start=0) + facet_grid(. ~ Area, scales="free")
national_bp
source('E:/TU Berlin/Case_Study_Group_20/dummy_script.R', echo=TRUE)
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white") + coord_polar("y") + facet_grid(. ~ Area, space="free")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area, space="free")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area)
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area) +
scale_fill_brewer(palette="Greens")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area) +
scale_fill_brewer(palette="Greens") +
geom_text(aes(y = Plot/2 + c(0, cumsum(Plot)[-length(Plot)]),
label = Plot), size=4)
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area) +
scale_fill_brewer(palette="Greens") +
geom_text(aes(y = "",
label = Plot), size=4)
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area) +
scale_fill_brewer(palette="Greens") +
geom_text(aes(label = Plot), size=4)
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area) +
scale_fill_brewer(palette="Greens")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area) +
scale_fill_brewer(palette="Greens") + geom_text(aes(label = Plot), position = position_stack(vjust = 0.5)) +
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area) +
scale_fill_brewer(palette="Greens") + geom_text(aes(label = Plot), position = position_stack(vjust = 0.5)) +
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area) +
scale_fill_brewer(palette="Greens") + geom_text(aes(label = Plot), position = position_stack(vjust = 0.5))
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area) +
scale_fill_brewer(palette="Greens") +
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area) +
scale_fill_brewer(palette="Greens")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") + facet_grid(. ~ Area,scales = "free") +
scale_fill_brewer(palette="Greens")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") +
scale_fill_brewer(palette="Greens") + facet_grid(. ~ Area)
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") +
scale_fill_brewer(palette="Greens") + facet_grid(. ~ Area) + geom_text(aes(label = Plot, y = position))
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") +
scale_fill_brewer(palette="Greens") + facet_grid(. ~ Area) + geom_text(aes(y = lab.ypos, label = Plot), color = "white")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") +
scale_fill_brewer(palette="Greens") + facet_grid(. ~ Area) + geom_text(aes(label = Plot), position = position_stack(vjust = 0.5), color = "white")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area) +
geom_text(aes(label = Plot), position = position_stack(vjust = 0.5), color = "white") +
scale_fill_brewer(palette="Greens")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity", color= "white",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area) +
geom_text(aes(label = Plot), position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette="Greens")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area) +
geom_text(aes(label = Plot), position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette="Greens")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area) +
geom_text(aes(label = Plot), position = position_stack(hjust = 0.5)) +
scale_fill_brewer(palette="Greens")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area) +
geom_text(aes(label = Plot), position = position_stack(vjust = 0.4)) +
scale_fill_brewer(palette="Greens")
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area) +
geom_text(aes(label = Plot), position = position_stack(vjust = 0.4)) +
scale_fill_brewer(palette="Greens") + theme_classic()
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area) +
geom_text(aes(label = Plot), position = position_stack(vjust = 0.4)) +
scale_fill_brewer(palette="Greens") + theme_grey()
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area) +
geom_text(aes(label = Plot), position = position_stack(vjust = 0.4)) +
scale_fill_brewer(palette="Greens") + theme_void()
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area) +
geom_text(aes(label = Plot), position = position_stack(vjust = 0.4)) +
scale_fill_brewer(palette="Greens") + theme_light()
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area) +
geom_text(aes(label = Plot), position = position_stack(vjust = 0.4))
national_bp
national_bp <- ggplot(national_df, aes(x="", y=Plot, fill=Group)) +
geom_bar(width = 0.9, stat = "identity",position = 'fill') + coord_polar("y") +
facet_grid(. ~ Area)
national_bp
