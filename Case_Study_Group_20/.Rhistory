Zulassungen %>% filter(IDNummer == ID_Car) %>% dplyr::select("Gemeinden")
ID_Car
head(Zulassungen)
Zulassungen %>% filter(IDNummer == ID_Car)
Zulassungen %>% filter(str_detect(IDNummer, ID_Car))
Zulassungen %>% filter(str_detect("IDNummer", ID_Car))
ID_Car
ID_Car[1]
ID_Car[[1]
]
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted) %>% dplyr::select("ID_Fahrzeug")[]
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted) %>% dplyr::select("ID_Fahrzeug")[1]
#Wanted ID:
ID_wanted <- "K1BE2-104-1041-32049"
ID_Car <- Bestandteile_Fahrzeuge_complete %>% filter(ID_Motor == ID_wanted) %>% dplyr::select("ID_Fahrzeug")
Zulassungen %>% filter(IDNummer == ID_Car[[1]]) %>% dplyr::select("Gemeinden")
fit.lognormal <- fitdist(df_combi$delay, "lnorm")
fit.lognormal
plot(fit.gamma)
fit.gamma <- fitdist(df_combi$delay, "gamma")
fit.gamma <- fitdist(df_combi$delay, "gamma")
plot(fit.gamma)
shiny::runApp('D:/UNI/Uni Synchro/DAP/Projekt/Gruppe_05_DQE2019')
runApp('D:/UNI/Uni Synchro/DAP/Projekt/Gruppe_05_DQE2019')
runApp('D:/UNI/Uni Synchro/DAP/Projekt/Gruppe_05_DQE2019')
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "D:/UNI/IDA CaseStudy/Data/") #Set working directory
Fahrzeuge_ID_1 <- read_csv("Fahrzeug/Fahrzeuge_OEM1_Typ11.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_date(format = "%Y-%m-%d"),
X1 = col_skip(), X1_1 = col_skip()))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "D:/UNI/IDA CaseStudy/Data/") #Set working directory
if(!require(dplyr)){
install.packages("dplyr")
require(dplyr)
}
if(!require(data.table)){
install.packages("data.table")
require(data.table)
}
if(!require(ggplot2)){
install.packages("ggplot2")
require(ggplot2)
}
if(!require(tidyverse)){
install.packages("tidyverse")
require(tidyverse)
}
if(!require(readr)){
install.packages("readr")
require(readr)
}
#Car-IDs -> Faulty/Broken car? -> Don't include if ban is after failure date
Fahrzeuge_ID_1 <- read_csv("Fahrzeug/Fahrzeuge_OEM1_Typ11.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_date(format = "%Y-%m-%d"),
X1 = col_skip(), X1_1 = col_skip()))
head(Fahrzeuge_ID_1)
Fahrzeuge_ID_2 <- read_delim("Fahrzeug/Fahrzeuge_OEM1_Typ12.csv",
";", escape_double = FALSE,
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_date(format = "%Y-%m-%d"),
X1 = col_skip(), X1_1 = col_skip()), trim_ws = TRUE)
head(Fahrzeuge_ID_2)
Fahrzeuge_ID_3 <- read_delim("Fahrzeug/Fahrzeuge_OEM2_Typ21.csv",
";", escape_double = FALSE,
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_date(format = "%Y-%m-%d"),
X1 = col_skip(), X1_1 = col_skip()), trim_ws = TRUE)
head(Fahrzeuge_ID_3)
Fahrzeuge_ID_3 <- read_delim("Fahrzeug/Fahrzeuge_OEM2_Typ21.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_date(format = "%Y-%m-%d"),
X1 = col_skip(), X1_1 = col_skip()), trim_ws = TRUE)
Fahrzeuge_ID_3 <- read_csv("Fahrzeug/Fahrzeuge_OEM2_Typ21.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_date(format = "%Y-%m-%d"),
X1 = col_skip(), X1_1 = col_skip()), trim_ws = TRUE)
head(Fahrzeuge_ID_3)
Fahrzeuge_ID_4 <- read_delim("Fahrzeug/Fahrzeuge_OEM2_Typ22.csv",
";", escape_double = FALSE,
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_date(format = "%Y-%m-%d"),
X1 = col_skip(), X1_1 = col_skip()), trim_ws = TRUE)
head(Fahrzeuge_ID_4)
Fahrzeuge_ID_1 <- read_csv("Fahrzeug/Fahrzeuge_OEM1_Typ11.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_010 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
head(Fahrzeuge_ID_1)
Fahrzeuge_ID_1 <- read_csv("Fahrzeug/Fahrzeuge_OEM1_Typ11.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_010 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
Fahrzeuge_ID_2 <- read_delim("Fahrzeug/Fahrzeuge_OEM1_Typ12.csv",
";", escape_double = FALSE,
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_010 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
Fahrzeuge_ID_3 <- read_csv("Fahrzeug/Fahrzeuge_OEM2_Typ21.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_010 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
Fahrzeuge_ID_4 <- read_delim("Fahrzeug/Fahrzeuge_OEM2_Typ22.csv",
";", escape_double = FALSE,
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_010 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
head(Fahrzeuge_ID_1)
head(Fahrzeuge_ID_2)
head(Fahrzeuge_ID_3)
head(Fahrzeuge_ID_4)
Fahrzeuge_ID_3 <- read_csv("Fahrzeug/Fahrzeuge_OEM2_Typ21.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_01011970 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
Fahrzeuge_ID_4 <- read_delim("Fahrzeug/Fahrzeuge_OEM2_Typ22.csv",
";", escape_double = FALSE,
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_01011970 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
head(Fahrzeuge_ID_3)
head(Fahrzeuge_ID_4)
#Engine-IDs -> Diesel vs. Petrol:
Fehler_Fahrzeuge_1 <- fread('Fahrzeug/Fahrzeuge_OEM1_Typ11.csv', header=TRUE)
head(Fehler_Fahrzeuge_1)
Fehler_Fahrzeuge_1 <- read_delim("Fahrzeug/Bestandteile_Fahrzeuge_OEM1_Typ11.csv",
";", escape_double = FALSE,
col_types = cols(ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
Fehler_Fahrzeuge_2 <- read_delim("Fahrzeug/Bestandteile_Fahrzeuge_OEM1_Typ12.csv",
";", escape_double = FALSE,
col_types = cols(ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
Fehler_Fahrzeuge_3 <- read_delim("Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ21.csv",
";", escape_double = FALSE,
col_types = cols(ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
Fehler_Fahrzeuge_4 <- read_delim("Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ22.csv",
";", escape_double = FALSE,
col_types = cols(ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
head(Fehler_Fahrzeuge_1)
Fahrzeuge_ID_4 <- read_csv2("Fahrzeug/Fahrzeuge_OEM2_Typ22.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_01011970 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
head(Fahrzeuge_ID_4)
Fahrzeuge_ID_2 <- read_csv2("Fahrzeug/Fahrzeuge_OEM1_Typ12.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_010 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
head(Fehler_Fahrzeuge_4)
Fehler_Fahrzeuge_1 <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM1_Typ11.csv",
col_types = cols(X1 = col_skip(),
ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
Fehler_Fahrzeuge_2 <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM1_Typ12.csv",
col_types = cols(X1 = col_skip(),
ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
Fehler_Fahrzeuge_3 <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ21.csv",
col_types = cols(X1 = col_skip(),
ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
Fehler_Fahrzeuge_4 <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ22.csv",
col_types = cols(X1 = col_skip(),
ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
head(Fehler_Fahrzeuge_4)
#Registration date and place
Zulassungen <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ22.csv",
col_types = cols(X1 = col_skip(),
ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
head(Zulassungen)
#Registration date and place
Zulassungen <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ22.csv",
col_types = cols())
head(Zulassungen)
#Registration date and place
Zulassungen <- read_csv2("Zulassungen/Zulassungen_alle_Fahrzeuge.csv",
col_types = cols())
head(Zulassungen)
head(Zulassungen)
#Gedata of place:
Geodata <- fread('Geodaten/Geodaten_Gemeinden_v1.2_2017-08-22_TrR.csv', header=TRUE)
head(Geodata)
#Gedata of place:
Geodata <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ22.csv",
col_types = cols(V1 = col_skip()))
head(Geodata)
#Gedata of place:
Geodata <- read_csv2("Geodaten/Geodaten_Gemeinden_v1.2_2017-08-22_TrR",
col_types = cols(V1 = col_skip()))
#Gedata of place:
Geodata <- read_csv2("Geodaten/Geodaten_Gemeinden_v1.2_2017-08-22_TrR.csv",
col_types = cols(V1 = col_skip()))
head(Geodata)
#Gedata of place:
Geodata <- read_csv2("Geodaten/Geodaten_Gemeinden_v1.2_2017-08-22_TrR.csv",
col_types = cols(X1 = col_skip()))
head(Geodata)
head(Zulassungen)
#Combine to one ID-File:
Fahrzeuge_ID <- rbind(Fahrzeuge_ID_1, Fahrzeuge_ID_2, Fahrzeuge_ID_3, Fahrzeuge_ID_4)
nrow(Fahrzeuge_ID) - nrow(Fahrzeuge_ID_1) - nrow(Fahrzeuge_ID_2) - nrow(Fahrzeuge_ID_3) - nrow(Fahrzeuge_ID_4)
#Combine to one Error-File:
Fehler_Fahrzeuge <- rbind(Fehler_Fahrzeuge_1, Fehler_Fahrzeuge_2, Fehler_Fahrzeuge_3, Fehler_Fahrzeuge_4)
head(Geodata)
head(Fehler_Fahrzeuge)
View(Fahrzeuge_ID)
head(Fahrzeuge_ID)
#Now combine everything:
#1.) Combine the defects information with the engine information:
Fehler <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
head(Fehler)
#2.) Combine this data frame with the registration information:
All_information <- inner_join(All_information, Zulassungen, by = "ID_Fahrzeug")
#Now combine everything:
#1.) Combine the defects information with the engine information:
All_information <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
#Now combine everything:
#1.) Combine the defects information with the engine information:
All_information <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
#2.) Combine this data frame with the registration information:
All_information <- inner_join(All_information, Zulassungen, by = "ID_Fahrzeug")
head(All_information)
head(Zulassungen)
#2.) Combine this data frame with the registration information:
All_information <- inner_join(All_information, Zulassungen, by = c("ID_Fahrzeug" = "IDNummer"))
remove(All_information)
remove(Fehler)
#Now combine everything:
#1.) Combine the defects information with the engine information:
complete_information <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
#2.) Combine this data frame with the registration information:
complete_information <- inner_join(complete_information, Zulassungen, by = c("ID_Fahrzeug" = "IDNummer"))
head(complete_information)
head(Zulassungen)
#3.) Combine this data frame with the geodata:
complete_information <- inner_join(complete_information, Zulassungen, by = "Gemeinden")
head(complete_information)
#3.) Combine this data frame with the geodata:
complete_information <- inner_join(complete_information, Geodata, by = "Gemeinden")
head(Geodata)
#3.) Combine this data frame with the geodata:
complete_information <- inner_join(complete_information, Geodata, by = "Gemeinde")
#3.) Combine this data frame with the geodata:
complete_information <- inner_join(complete_information, Geodata, by = c("Gemeinden" = "Gemeinde"))
head(complete_information)
head(Zulassungen)
#Registration date and place
#We need the place and date of registration
Zulassungen <- read_csv2("Zulassungen/Zulassungen_alle_Fahrzeuge.csv",
col_types = cols(X1 = col_skip()))
head(Zulassungen)
#Now combine everything:
#1.) Combine the defects information with the engine information:
complete_information <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
#3.) Combine this data frame with the geodata:
complete_information <- inner_join(complete_information, Geodata, by = c("Gemeinden" = "Gemeinde"))
#3.) Combine this data frame with the geodata:
complete_information <- inner_join(complete_information, Geodata, by = c("Gemeinde" = "Gemeinden"))
#3.) Combine this data frame with the geodata:
complete_information <- inner_join(complete_information, Geodata, by = c("Gemeinden" = "Gemeinde"))
head(complete_information)
#2.) Combine this data frame with the registration information:
complete_information <- inner_join(complete_information, Zulassungen, by = c("ID_Fahrzeug" = "IDNummer"))
head(complete_information)
head(Geodata)
#3.) Combine this data frame with the geodata:
complete_information <- inner_join(complete_information, Geodata, by = c("Gemeinden" = "Gemeinde"))
head(complete_information)
#Gedata of place
#We need latitute and altitude of every commune and the post code
Geodata <- read_csv2("Geodaten/Geodaten_Gemeinden_v1.2_2017-08-22_TrR.csv",
col_types = cols(X1 = col_skip(), X = col_skip()))
#3.) Combine this data frame with the geodata:
complete_information <- inner_join(complete_information, Geodata, by = c("Gemeinden" = "Gemeinde"))
head(complete_information)
head(Geodata)
head(Zulassungen)
#Now combine everything:
#1.) Combine the defects information with the engine information:
complete_information <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
#Now combine everything:
#1.) Combine the defects information with the engine information:
complete_information <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
#2.) Combine this data frame with the registration information:
complete_information <- inner_join(complete_information, Zulassungen, by = c("ID_Fahrzeug" = "IDNummer"))
#3.) Combine this data frame with the geodata:
complete_information <- inner_join(complete_information, Geodata, by = c("Gemeinden" = "Gemeinde"))
head(Zulassungen)
head(complete_information)
#Now combine everything:
#1.) Combine the defects information with the engine information:
complete_information <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
#2.) Combine this data frame with the registration information:
complete_information <- inner_join(complete_information, Zulassungen, by = c("ID_Fahrzeug" = "IDNummer"))
str(Gemeinden)
str(Geodata)
summary(Geodata)
nlevels(Geodata$Gemeinde)
length(unique(Geodata$Gemeinde))
Geodata$Gemeinde
View(Geodata)
length(unique(Zulassungen$Gemeinden))
#3.) Combine this data frame with the geodata:
complete_information <- left_join(complete_information, Geodata, by = c("Gemeinden" = "Gemeinde"))
#3.) Combine this data frame with the geodata:
complete_information <- left_join(complete_information, Geodata, by = c("Gemeinden" = "Gemeinde"))
#Now combine everything:
#1.) Combine the defects information with the engine information:
complete_information <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
#Now combine everything:
#1.) Combine the defects information with the engine information:
complete_information <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
#2.) Combine this data frame with the registration information:
complete_information <- inner_join(complete_information, Zulassungen, by = c("ID_Fahrzeug" = "IDNummer"))
#3.) Combine this data frame with the geodata:
complete_information <- left_join(complete_information, Geodata, by = c("Gemeinden" = "Gemeinde"))
#Save data frame as csv:
write.csv(complete_information, "Case_Study_Data.csv")
#Save data frame as csv:
write.csv(complete_information, "Case_Study_Data.csv")
write.csv(complete_information, "Case_Study_Data.csv")
head(Fehler_Fahrzeuge)
head(Fehler_Fahrzeuge)
distinct(Fehler_Fahrzeuge$ID_Motor)
unique(Fehler_Fahrzeuge$ID_Motor)
#Change the engine column to diesel/petrol -> K1D... -> "Diesel", K1B... -> "Benzin"
index <- str_detect(Fehler_Fahrzeuge$ID_Motor, "K1B")
head(index)
index
#Change the engine column to diesel/petrol -> K1D... -> "Diesel", K1B... -> "Benzin"
Fehler_Fahrzeuge[, "ID_Motor"] <- 0 #Diesel
index_B <- str_detect(Fehler_Fahrzeuge$ID_Motor, "K1B")
index_B <- str_detect(Fehler_Fahrzeuge$ID_Motor, "K1B")
Fehler_Fahrzeuge[index_B, "ID_Motor"] <- 1
head(Fehler_Fahrzeuge$ID_Motor)
Fehler_Fahrzeuge$ID_Motor
index_B
index_B <- str_detect(Fehler_Fahrzeuge$ID_Motor, "K1B")
index_B
unique(index_B)
head(Fehler_Fahrzeuge)
#Combine to one Error-File:
Fehler_Fahrzeuge <- rbind(Fehler_Fahrzeuge_1, Fehler_Fahrzeuge_2, Fehler_Fahrzeuge_3, Fehler_Fahrzeuge_4)
head(Fehler_Fahrzeuge)
str_detect("K1BE1-101-1011-7", "K1B")
index_B <- str_detect(Fehler_Fahrzeuge$ID_Motor, "K1B")
unique(index_B)
head(Fehler_Fahrzeuge)
index_B
#Change the engine column to diesel/petrol -> K1D... -> "Diesel", K1B... -> "Benzin"
index_B <- str_detect(Fehler_Fahrzeuge$ID_Motor, "K1B")
Fehler_Fahrzeuge[, "ID_Motor"] <- 0 #Diesel
Fehler_Fahrzeuge[index_B, "ID_Motor"] <- 1 # Benzin
head(Fehler_Fahrzeuge)
Fehler_Fahrzeuge$ID_Motor
n
#Change the engine column to diesel/petrol -> K1D... -> "Diesel", K1B... -> "Benzin"
index_B <- str_detect(Fehler_Fahrzeuge$ID_Motor, "K1B")
head(Fehler_Fahrzeuge$ID_Motor)
head(Fehler_Fahrzeuge$ID_Motor)
#Combine to one Error-File:
Fehler_Fahrzeuge <- rbind(Fehler_Fahrzeuge_1, Fehler_Fahrzeuge_2, Fehler_Fahrzeuge_3, Fehler_Fahrzeuge_4)
#Change the engine column to diesel/petrol -> K1D... -> "Diesel", K1B... -> "Benzin"
index_B <- str_detect(Fehler_Fahrzeuge$ID_Motor, "K1B")
Fehler_Fahrzeuge[index_B, "ID_Motor"] <- "Benzin"
head(Fehler_Fahrzeuge$ID_Motor)
Fehler_Fahrzeuge$ID_Motor <- as.factor(Fehler_Fahrzeuge$ID_Motor)
Fehler_Fahrzeuge$ID_Motor <- as.factor(Fehler_Fahrzeuge$ID_Motor)
if(!require(dplyr)){
install.packages("dplyr")
require(dplyr)
}
if(!require(tidyverse)){
install.packages("tidyverse")
require(tidyverse)
}
if(!require(readr)){
install.packages("readr")
require(readr)
}
if(!require(stringr)){
install.packages("stringr")
require(stringr)
}
#Car-IDs -> Faulty/Broken car? -> So that we can exclude cars that are broken after the ban date
#We need the information wheather the car is broken and the Car failure date
Fahrzeuge_ID_1 <- read_csv("Fahrzeug/Fahrzeuge_OEM1_Typ11.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_010 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
Fahrzeuge_ID_2 <- read_csv2("Fahrzeug/Fahrzeuge_OEM1_Typ12.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_010 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
Fahrzeuge_ID_3 <- read_csv("Fahrzeug/Fahrzeuge_OEM2_Typ21.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_01011970 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
Fahrzeuge_ID_4 <- read_csv2("Fahrzeug/Fahrzeuge_OEM2_Typ22.csv",
col_types = cols(Fehlerhaft = col_logical(),
Fehlerhaft_Datum = col_date(format = "%Y-%m-%d"),
Produktionsdatum = col_skip(), Werksnummer = col_skip(),
Fehlerhaft_Fahrleistung = col_skip(), Herstellernummer = col_skip(),
Produktionsdatum_Origin_01011970 = col_skip(), origin = col_skip(),
X1 = col_skip(), X1_1 = col_skip()))
#Combine to one ID-File:
Fahrzeuge_ID <- rbind(Fahrzeuge_ID_1, Fahrzeuge_ID_2, Fahrzeuge_ID_3, Fahrzeuge_ID_4)
#Engine-IDs -> Diesel vs. Petrol:
Fehler_Fahrzeuge_1 <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM1_Typ11.csv",
col_types = cols(X1 = col_skip(),
ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
Fehler_Fahrzeuge_2 <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM1_Typ12.csv",
col_types = cols(X1 = col_skip(),
ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
Fehler_Fahrzeuge_3 <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ21.csv",
col_types = cols(X1 = col_skip(),
ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
Fehler_Fahrzeuge_4 <- read_csv2("Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ22.csv",
col_types = cols(X1 = col_skip(),
ID_Karosserie = col_skip(),
ID_Schaltung = col_skip(),
ID_Sitze = col_skip()))
#Combine to one Error-File:
Fehler_Fahrzeuge <- rbind(Fehler_Fahrzeuge_1, Fehler_Fahrzeuge_2, Fehler_Fahrzeuge_3, Fehler_Fahrzeuge_4)
#Change the engine column to diesel/petrol -> K1D... -> "Diesel", K1B... -> "Benzin"
index_B <- str_detect(Fehler_Fahrzeuge$ID_Motor, "K1B")
Fehler_Fahrzeuge[, "ID_Motor"] <- "Diesel"
Fehler_Fahrzeuge[index_B, "ID_Motor"] <- "Benzin"
Fehler_Fahrzeuge$ID_Motor <- as.factor(Fehler_Fahrzeuge$ID_Motor)
#Registration date and place
#We need the place and date of registration
Zulassungen <- read_csv2("Zulassungen/Zulassungen_alle_Fahrzeuge.csv",
col_types = cols(X1 = col_skip()))
#Gedata of place
#We need latitute and altitude of every commune and the post code
Geodata <- read_csv2("Geodaten/Geodaten_Gemeinden_v1.2_2017-08-22_TrR.csv",
col_types = cols(X1 = col_skip(), X = col_skip()))
#Now combine everything:
#1.) Combine the defects information with the engine information:
complete_information <- inner_join(Fahrzeuge_ID, Fehler_Fahrzeuge, by = "ID_Fahrzeug")
#2.) Combine this data frame with the registration information:
complete_information <- inner_join(complete_information, Zulassungen, by = c("ID_Fahrzeug" = "IDNummer"))
#3.) Combine this data frame with the geodata:
complete_information <- left_join(complete_information, Geodata, by = c("Gemeinden" = "Gemeinde"))
#Save data frame as csv:
setwd("C:/Users/sahid/Documents/GitHub/IDACase_Study/Case_Study_Group_20")
write.csv(complete_information, "Case_Study_Data.csv")
